<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    
</body>

<script src="/socket.io/socket.io.js"></script>
<script>
    const socket = io();

    socket.on("connect", ()=>{
        alert("conectado");
    });

    let user_id = "";
    socket.on("connect", ()=>{
        socket.on('get-id', id=>{
            document.querySelector(".socket-id").textContent = id;
            socket.emit("user-connected", id);
            user_id = id;
        });
    });

    document.querySelector(".send").addEventListener("click", ()=>{
        let files = document.querySelector(".file");
        let file = files.files[0];

        if(!file){
            alert("Debe seleccionar un archivo.");
            return;
        }

        const reader = new FileReader();
        reader.onload = e=>{
            const content = e.target.result;
            const filename = file.name;
            socket.emit("upload-file", {filename, content});
        }

        reader.readAsBinaryString(file);
    });
    
</script>

</html>